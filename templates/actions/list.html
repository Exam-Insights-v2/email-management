{% extends "base.html" %}

{% block title %}Actions | Email IQ{% endblock %}

{% block header_title %}All Actions{% endblock %}

{% block header_action %}
  {% include 'includes/create_modal.html' with modal_id="create-action" title="Create" form_template="actions/form_content.html" form_url="action_create" button_text="Create New Action" form=form %}
{% endblock %}

{% block content %}

<section class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-white/10 overflow-hidden mt-3">
  <ul role="list" class="divide-y divide-white/5">
    {% for action in actions %}
    <li class="flex justify-between gap-x-4 py-2.5 px-4 hover:bg-white/5 transition-colors cursor-pointer" onclick="window.location.href='{% url 'action_detail' action.pk %}'">
      <div class="flex min-w-0 gap-x-3 flex-1">
        <div class="size-8 flex-none rounded-full bg-gray-100 dark:bg-gray-700 outline -outline-offset-1 outline-gray-200 dark:outline-white/10 flex items-center justify-center">
          <i class="ti ti-bulb size-4 text-gray-600 dark:text-gray-400" aria-hidden="true"></i>
        </div>
        <div class="min-w-0 flex-auto">
          <p class="text-xs font-semibold text-gray-900 dark:text-white">{{ action.name }}</p>
          <p class="mt-0.5 truncate text-xs text-gray-600 dark:text-gray-400">
            {% if action.instructions %}{{ action.instructions|truncatewords:20 }}{% else %}{{ action.function }} | {{ action.account.email }}{% endif %}
          </p>
        </div>
      </div>
      <div class="hidden shrink-0 sm:flex sm:flex-col sm:items-end sm:gap-1.5">
        <div class="flex items-center gap-1.5">
          <div onclick="event.stopPropagation();">
            {% url 'action_detail' action.pk as action_detail_url %}
            {% url 'action_update' action.pk as action_update_url %}
            {% url 'action_delete' action.pk as action_delete_url %}
            {% include 'includes/action_dropdown.html' with view_url=action_detail_url edit_url=action_update_url delete_url=action_delete_url delete_message="Are you sure you want to delete this action?" %}
          </div>
        </div>
        <p class="mt-0.5 text-xs text-gray-600 dark:text-gray-400">
          Created <time datetime="{{ action.created_at|date:'Y-m-d' }}">{{ action.created_at|date:"d M Y" }}</time>
        </p>
      </div>
    </li>
    {% empty %}
    <li class="px-4 py-12 text-center">
      <div class="inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg mb-3">
        <svg width="24" height="24" class="w-6 h-6 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
        </svg>
      </div>
      <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">No actions yet.</p>
      <a href="{% url 'action_create' %}" class="inline-flex items-center justify-center gap-1.5 px-4 py-2 bg-cyan-600 text-white rounded-md font-semibold hover:bg-cyan-500 transition-colors text-xs">
        Create Your First Action
        <i class="ti ti-plus w-3.5 h-3.5 flex-shrink-0" aria-hidden="true"></i>
      </a>
    </li>
    {% endfor %}
  </ul>
</section>
{% endblock %}
