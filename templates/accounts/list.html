{% extends "base.html" %}

{% block title %}Accounts | Email IQ{% endblock %}

{% block header_title %}All Accounts{% endblock %}

{% block header_action %}
  {% include 'includes/create_modal.html' with modal_id="create-account" title="Create Account" form_template="accounts/form_content.html" form_url="account_create" button_text="Create New Account" form=form %}
{% endblock %}

{% block content %}

<section class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-white/10 overflow-hidden mt-3">
  <ul role="list" class="divide-y divide-gray-200 dark:divide-white/5">
    {% for account in accounts %}
    <li class="flex justify-between gap-x-4 py-2.5 px-4 hover:bg-gray-50 dark:hover:bg-white/5 transition-colors cursor-pointer" onclick="window.location.href='{% url 'account_detail' account.pk %}'">
      <div class="flex min-w-0 gap-x-3 flex-1">
        <div class="size-8 flex-none rounded-full bg-gray-100 dark:bg-gray-700 outline -outline-offset-1 outline-gray-200 dark:outline-white/10 flex items-center justify-center">
          <i class="ti ti-mail size-4 text-gray-600 dark:text-gray-400" aria-hidden="true"></i>
        </div>
        <div class="min-w-0 flex-auto">
          <p class="text-xs font-semibold text-gray-900 dark:text-white">{{ account.email }}</p>
          <p class="mt-0.5 truncate text-xs text-gray-600 dark:text-gray-400">{{ account.get_provider_display }}</p>
        </div>
      </div>
      <div class="hidden shrink-0 sm:flex sm:flex-col sm:items-end sm:gap-1.5">
        <div class="flex items-center gap-1.5">
          {% if account.is_connected %}
          <div class="flex items-center gap-x-1">
            <div class="flex-none rounded-full bg-emerald-500/30 p-0.5">
              <div class="size-1.5 rounded-full bg-emerald-500"></div>
            </div>
            <p class="text-xs text-gray-600 dark:text-gray-400">Connected</p>
          </div>
          {% else %}
          <p class="text-xs text-gray-600 dark:text-gray-400">Not Connected</p>
          {% endif %}
          <div onclick="event.stopPropagation();">
            {% url 'account_detail' account.pk as account_detail_url %}
            {% url 'account_update' account.pk as account_update_url %}
            {% url 'account_delete' account.pk as account_delete_url %}
            {% include 'includes/action_dropdown.html' with view_url=account_detail_url edit_url=account_update_url delete_url=account_delete_url delete_message="Are you sure you want to delete this account?" %}
          </div>
        </div>
      </div>
    </li>
    {% empty %}
    <li class="px-4 py-12 text-center">
      <div class="inline-flex items-center justify-center w-12 h-12 bg-gray-100 dark:bg-gray-700 rounded-lg mb-3">
        <svg width="24" height="24" class="w-6 h-6 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
        </svg>
      </div>
      <p class="text-gray-600 dark:text-gray-400 text-sm mb-3">No accounts yet.</p>
      <a href="{% url 'account_create' %}" class="inline-flex items-center justify-center gap-1.5 px-4 py-2 bg-cyan-600 text-white rounded-md font-semibold hover:bg-cyan-500 transition-colors text-xs">
        Connect Your First Account
        <i class="ti ti-bolt w-3.5 h-3.5 flex-shrink-0" aria-hidden="true"></i>
      </a>
    </li>
    {% endfor %}
  </ul>
</section>
{% endblock %}
