{% extends "base.html" %}

{% block title %}{{ title }} â€¢ LineMarking Ops{% endblock %}

{% block content %}
<div class="mb-6">
  <a href="{% if draft %}{% url 'draft_detail' draft.pk %}{% else %}{% url 'drafts_list' %}{% endif %}" class="inline-flex items-center gap-2 px-6 py-2.5 text-sm font-semibold text-white hover:text-cyan-400 transition-colors">
    <svg width="16" height="16" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
    </svg>
    Back
  </a>
</div>

<section class="bg-white shadow-lg rounded-xl border border-slate-200">
  <header class="px-6 py-5 border-b border-slate-200">
    <h2 class="text-2xl font-bold text-slate-900">{{ title }}</h2>
  </header>
  
  <form method="post" class="px-6 py-5">
    {% csrf_token %}
    
    <div class="space-y-6">
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Account <span class="text-red-500">*</span></label>
        <select name="account" class="w-full px-3 py-2 border border-slate-300 rounded-lg text-slate-900 bg-white" required>
          <option value="">Select an account...</option>
          {% for account in accounts %}
          <option value="{{ account.pk }}" {% if draft and draft.account.pk == account.pk %}selected{% endif %}>{{ account.email }}</option>
          {% endfor %}
        </select>
      </div>
      
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Replying To (optional)</label>
        <select name="email_message" class="w-full px-3 py-2 border border-slate-300 rounded-lg text-slate-900 bg-white">
          <option value="">None</option>
          {% for email in emails %}
          <option value="{{ email.pk }}" {% if draft and draft.email_message and draft.email_message.pk == email.pk %}selected{% endif %}>{{ email.subject|default:"No subject" }}</option>
          {% endfor %}
        </select>
      </div>
      
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">To (JSON array)</label>
        <textarea name="to_addresses" class="w-full px-3 py-2 border border-slate-300 rounded-lg text-slate-900 bg-white" rows="2" placeholder='["email@example.com"]'>{% if draft %}{{ draft.to_addresses|safe }}{% endif %}</textarea>
        <p class="mt-1 text-xs text-slate-500">Enter as JSON array, e.g. ["email@example.com"]</p>
      </div>
      
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">CC (JSON array, optional)</label>
        <textarea name="cc_addresses" class="w-full px-3 py-2 border border-slate-300 rounded-lg text-slate-900 bg-white" rows="2" placeholder='["cc@example.com"]'>{% if draft %}{{ draft.cc_addresses|safe }}{% endif %}</textarea>
      </div>
      
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Subject</label>
        <input type="text" name="subject" value="{% if draft %}{{ draft.subject }}{% endif %}" class="w-full px-3 py-2 border border-slate-300 rounded-lg text-slate-900 bg-white">
      </div>
      
      <div>
        <label class="block text-sm font-semibold text-slate-700 mb-1">Body (HTML)</label>
        <textarea name="body_html" class="w-full px-3 py-2 border border-slate-300 rounded-lg text-slate-900 bg-white" rows="10">{% if draft %}{{ draft.body_html }}{% endif %}</textarea>
      </div>
    </div>
    
    <div class="mt-6 flex gap-3">
      <button type="submit" class="px-6 py-2.5 bg-cyan-600 text-white rounded-full hover:bg-cyan-500 font-semibold transition-colors">
        Save
      </button>
      <a href="{% if draft %}{% url 'draft_detail' draft.pk %}{% else %}{% url 'drafts_list' %}{% endif %}" class="px-6 py-2.5 bg-white border-2 border-slate-200 text-slate-700 rounded-full hover:border-cyan-400 hover:text-cyan-600 font-semibold transition-all duration-300">
        Cancel
      </a>
    </div>
  </form>
</section>
{% endblock %}
