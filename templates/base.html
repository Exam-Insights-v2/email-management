<!DOCTYPE html>
<html lang="en" class="h-full scroll-smooth">
  {% load static %}
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}EmailIQ{% endblock %}</title>
    <link rel="icon" type="image/png" href="{% static 'images/logo.png' %}" />
    <link rel="apple-touch-icon" href="{% static 'images/logo.png' %}" />
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Include @tailwindplus/elements for header components -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindplus/elements@1" type="module"></script>
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['Roboto', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Helvetica Neue', 'Arial', 'sans-serif'],
            },
          },
        },
      }
    </script>
    <style>
      /* Email body styling to look like a real email client */
      .email-body {
        font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
        font-size: 15px;
        line-height: 1.6;
        color: #1e293b;
        width: 100%;
        word-wrap: break-word;
        word-break: break-word;
        overflow-wrap: break-word;
        white-space: normal;
        font-weight: 400;
      }
      
      .dark .email-body {
        color: #e2e8f0;
      }
      
      /* Smooth drawer animations */
      dialog[open] {
        animation: fadeIn 0.2s ease-out;
      }
      
      dialog:not([open]) {
        animation: fadeOut 0.2s ease-in;
      }
      
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }
      
      @keyframes fadeOut {
        from {
          opacity: 1;
        }
        to {
          opacity: 0;
        }
      }
      
      /* Ensure smooth transitions for drawer panel */
      el-dialog-panel {
        will-change: transform;
      }
      
      /* Smooth backdrop fade */
      el-dialog-backdrop {
        will-change: opacity;
      }
      
      /* Reset and normalize email HTML */
      .email-body * {
        box-sizing: border-box;
      }
      
      .email-body p {
        margin: 0 0 1em 0;
        padding: 0;
      }
      
      .email-body p:last-child {
        margin-bottom: 0;
      }
      
      .email-body img {
        max-width: 100% !important;
        height: auto !important;
        margin: 1em 0;
        display: block;
      }
      
      .email-body table {
        width: 100%;
        border-collapse: collapse;
        margin: 1.5em 0;
        background-color: #ffffff;
      }
      
      .email-body table td,
      .email-body table th {
        border: 1px solid #dadce0;
        padding: 12px;
        text-align: left;
      }
      
      .email-body table th {
        background-color: #f8f9fa;
        font-weight: 600;
      }
      
      .email-body table tr:nth-child(even) {
        background-color: #f8f9fa;
      }
      
      .email-body pre {
        background: #f8f9fa;
        padding: 16px;
        overflow-x: auto;
        border: 1px solid #dadce0;
        margin: 1.5em 0;
        font-family: 'Courier New', Courier, monospace;
        font-size: 13px;
        line-height: 1.5;
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      
      .email-body code {
        background: #f8f9fa;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: 'Courier New', Courier, monospace;
        font-size: 14px;
        border: 1px solid #dadce0;
      }
      
      .email-body blockquote {
        border-left: 4px solid #06b6d4;
        padding: 12px 16px;
        margin: 1.5em 0;
        background-color: #f8f9fa;
        color: #5f6368;
        font-style: italic;
        border-radius: 0 4px 4px 0;
      }
      
      .email-body a {
        color: #1a73e8;
        text-decoration: none;
      }
      
      .email-body a:hover {
        text-decoration: underline;
      }
      
      .email-body ul,
      .email-body ol {
        margin: 1em 0;
        padding-left: 2em;
      }
      
      .email-body li {
        margin: 0.5em 0;
      }
      
      .email-body h1,
      .email-body h2,
      .email-body h3,
      .email-body h4,
      .email-body h5,
      .email-body h6 {
        font-weight: 600;
        margin-top: 1.5em;
        margin-bottom: 0.75em;
        color: #202124;
        line-height: 1.3;
      }
      
      .dark .email-body h1,
      .dark .email-body h2,
      .dark .email-body h3,
      .dark .email-body h4,
      .dark .email-body h5,
      .dark .email-body h6 {
        color: #f1f5f9;
      }
      
      .email-body h1 { 
        font-size: 24px; 
        border-bottom: 2px solid #dadce0;
        padding-bottom: 8px;
      }
      
      .email-body h2 { 
        font-size: 20px; 
      }
      
      .email-body h3 { 
        font-size: 18px; 
      }
      
      .email-body h4 { 
        font-size: 16px; 
      }
      
      .email-body h5,
      .email-body h6 { 
        font-size: 15px; 
      }
      
      /* Email signature styling */
      .email-body .gmail_signature,
      .email-body .email-signature {
        margin-top: 2em;
        padding-top: 1em;
        border-top: 1px solid #dadce0;
        color: #5f6368;
        font-size: 13px;
      }
      
      /* Quoted/replied email styling */
      .email-body blockquote[type="cite"],
      .email-body .gmail_quote {
        border-left: 3px solid #dadce0;
        padding-left: 16px;
        margin: 1.5em 0;
        color: #5f6368;
        font-size: 13px;
      }
      
      /* Horizontal rules */
      .email-body hr {
        border: none;
        border-top: 1px solid #dadce0;
        margin: 2em 0;
      }
      
      /* Div containers */
      .email-body div {
        margin: 0;
      }
      
      /* Remove excessive spacing from email clients */
      .email-body br + br {
        display: none;
      }
      
      /* Style email-specific elements */
      .email-body .moz-cite-prefix {
        color: #5f6368;
        font-size: 13px;
      }
      
      /* Ensure proper spacing for email content */
      .email-body > *:first-child {
        margin-top: 0;
      }
      
      .email-body > *:last-child {
        margin-bottom: 0;
      }
    </style>
    <script>
      // Theme management
      (function() {
        // Get theme from localStorage or default to dark
        const getTheme = () => {
          const stored = localStorage.getItem('theme');
          if (stored) return stored;
          // Check system preference
          return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        };

        // Apply theme
        const applyTheme = (theme) => {
          const html = document.documentElement;
          if (theme === 'dark') {
            html.classList.add('dark');
          } else {
            html.classList.remove('dark');
          }
        };

        // Set initial theme before page renders to prevent flash
        applyTheme(getTheme());

        // Expose theme toggle function
        window.toggleTheme = function() {
          const currentTheme = getTheme();
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          localStorage.setItem('theme', newTheme);
          applyTheme(newTheme);
        };

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
          if (!localStorage.getItem('theme')) {
            applyTheme(e.matches ? 'dark' : 'light');
          }
        });
      })();

      // Handle warning modal form submissions
      document.addEventListener('DOMContentLoaded', function() {
        // Find all forms with data-warning-modal attribute
        document.querySelectorAll('form[data-warning-modal]').forEach(function(form) {
          const modalId = form.getAttribute('data-warning-modal');
          const confirmButton = document.getElementById(modalId + '-confirm');
          
          if (confirmButton) {
            // Prevent default form submission
            form.addEventListener('submit', function(e) {
              e.preventDefault();
              // Show the modal
              const modal = document.getElementById(modalId);
              if (modal) {
                modal.showModal();
              }
            });
            
            // Handle confirm button click
            confirmButton.addEventListener('click', function() {
              // Close modal and submit form
              const modal = document.getElementById(modalId);
              if (modal) {
                modal.close();
              }
              form.submit();
            });
          }
        });
      });
    </script>
  </head>
  <body class="h-full bg-white dark:bg-gray-900">
    {% block header %}
    {% include 'includes/header.html' %}
    {% endblock %}
    <header class="relative bg-white dark:bg-gray-800 after:pointer-events-none after:absolute after:inset-x-0 after:inset-y-0 after:border-y after:border-gray-200 dark:after:border-white/10">
      <div class="mx-auto max-w-7xl px-4 py-2 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between py-2">
          <h1 class="text-xl font-bold tracking-tight text-gray-900 dark:text-white">{% block header_title %}Jobs{% endblock %}</h1>
          <div class="flex items-center">
            {% block header_action %}{% endblock %}
          </div>
        </div>
      </div>
    </header>
    <main>
      <div class="mx-auto max-w-7xl px-4 py-3 sm:px-6 lg:px-8">
        {% if messages %}
        <div class="mb-3 space-y-2">
          {% for message in messages %}
          <div class="p-2 rounded-lg {% if message.tags == 'error' %}bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-200 border border-red-200 dark:border-red-800{% elif message.tags == 'success' %}bg-emerald-50 dark:bg-emerald-900/20 text-emerald-800 dark:text-emerald-200 border border-emerald-200 dark:border-emerald-800{% else %}bg-cyan-50 dark:bg-cyan-900/20 text-cyan-800 dark:text-cyan-200 border border-cyan-200 dark:border-cyan-800{% endif %} text-sm">
            {{ message }}
          </div>
          {% endfor %}
        </div>
        {% endif %}
        {% block content %}{% endblock %}
      </div>
    </main>
  </body>
</html>
