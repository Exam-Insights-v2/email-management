{% comment %}
Reusable action dropdown component
Usage:
  {% include 'includes/action_dropdown.html' with view_url=object.get_absolute_url edit_url=object.get_edit_url delete_url=object.get_delete_url delete_message="Are you sure?" %}
  
Parameters:
  - view_url: URL for view action (optional)
  - edit_url: URL for edit action (optional)
  - delete_url: URL for delete action (optional)
  - delete_message: Confirmation message for delete (optional, defaults to "Are you sure?")
{% endcomment %}

<el-dropdown class="inline-block">
  <button class="inline-flex items-center justify-center rounded-md text-gray-600 dark:text-gray-400 focus:outline-2 focus:outline-offset-2 focus:outline-cyan-500 transition-colors" aria-label="Options">
    <span class="material-icons size-5" aria-hidden="true">more_vert</span>
  </button>

  <el-menu anchor="bottom end" popover class="w-56 origin-top-right rounded-md bg-white dark:bg-gray-800 outline-1 -outline-offset-1 outline-gray-200 dark:outline-white/10 transition transition-discrete [--anchor-gap:--spacing(0.5)] data-closed:scale-95 data-closed:transform data-closed:opacity-0 data-enter:duration-100 data-enter:ease-out data-leave:duration-75 data-leave:ease-in shadow-sm">
    <div class="py-1">
      {% if view_url or view_onclick %}
      {% if view_onclick %}
      <button type="button" onclick="{{ view_onclick }}" class="flex items-center gap-3 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 focus:bg-gray-100 dark:focus:bg-white/5 focus:text-gray-900 dark:focus:text-white focus:outline-hidden">
        <span class="material-icons size-4 text-gray-500 dark:text-gray-400" aria-hidden="true">visibility</span>
        <span>View</span>
      </button>
      {% else %}
      <a href="{{ view_url }}" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 focus:bg-gray-100 dark:focus:bg-white/5 focus:text-gray-900 dark:focus:text-white focus:outline-hidden">
        <span class="material-icons size-4 text-gray-500 dark:text-gray-400" aria-hidden="true">visibility</span>
        <span>View</span>
      </a>
      {% endif %}
      {% endif %}
      {% if edit_url %}
      {% if '/tasks/' in edit_url and '/edit' in edit_url %}
      <button type="button" onclick="event.stopPropagation(); const urlParts = '{{ edit_url }}'.split('/'); const pk = urlParts[urlParts.length - 2]; if (window.openEditTaskDrawer) window.openEditTaskDrawer(pk);" class="flex items-center gap-3 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 focus:bg-gray-100 dark:focus:bg-white/5 focus:text-gray-900 dark:focus:text-white focus:outline-hidden">
        <span class="material-icons size-4 text-gray-500 dark:text-gray-400" aria-hidden="true">edit</span>
        <span>Edit</span>
      </button>
      {% else %}
      <a href="{{ edit_url }}" class="flex items-center gap-3 px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 focus:bg-gray-100 dark:focus:bg-white/5 focus:text-gray-900 dark:focus:text-white focus:outline-hidden">
        <span class="material-icons size-4 text-gray-500 dark:text-gray-400" aria-hidden="true">edit</span>
        <span>Edit</span>
      </a>
      {% endif %}
      {% endif %}
      {% if delete_url %}
      {% with modal_id="delete-modal-"|add:delete_url|slugify %}
      <form action="{{ delete_url }}" method="POST" data-warning-modal="{{ modal_id }}">
        {% csrf_token %}
        <button type="submit" class="flex items-center gap-3 w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-white/5 focus:bg-gray-100 dark:focus:bg-white/5 focus:text-gray-900 dark:focus:text-white focus:outline-hidden">
          <span class="material-icons size-4 text-gray-500 dark:text-gray-400" aria-hidden="true">delete</span>
          <span>Delete</span>
        </button>
      </form>
      {% include 'includes/warning_modal.html' with modal_id=modal_id title="Delete item" message=delete_message|default:"Are you sure you want to delete this item?" confirm_text="Delete" %}
      {% endwith %}
      {% endif %}
    </div>
  </el-menu>
</el-dropdown>
