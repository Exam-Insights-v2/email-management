<form method="get" action="{% url 'tasks_list' %}">
  
  {% if form.non_field_errors %}
  <div class="mb-4 p-4 bg-red-500/10 border border-red-500/20 rounded-md text-sm text-red-400">
    {{ form.non_field_errors }}
  </div>
  {% endif %}
  
  <div class="border-t border-gray-200 dark:border-white/10">
    <dl class="divide-y divide-gray-200 dark:divide-white/10">
      {% for field in form %}
      {% if field.field.widget.input_type != 'hidden' %}
      <div class="px-0 py-3 sm:py-4 sm:grid sm:grid-cols-3 sm:gap-4">
        <dt class="text-xs sm:text-sm font-medium text-gray-900 dark:text-gray-100 mb-1 sm:mb-0">
          {{ field.label }}
          {% if field.field.required %}<span class="text-red-400">*</span>{% endif %}
        </dt>
        <dd class="text-xs sm:text-sm text-gray-700 dark:text-gray-300 sm:col-span-2 sm:mt-0">
          {% if field.name == 'status' or field.name == 'priority' or field.name == 'label' %}
            <div class="space-y-2">
              <ul class="space-y-2">
                {% for choice in field %}
                  <li class="flex items-center">
                    <div class="group grid size-4 grid-cols-1 flex-shrink-0">
                      {{ choice.tag }}
                      <span class="material-icons pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center text-white opacity-0 group-has-checked:opacity-100" aria-hidden="true">check</span>
                    </div>
                    <label for="{{ choice.id_for_label }}" class="ml-2 text-xs sm:text-sm text-gray-700 dark:text-gray-300 cursor-pointer">
                      {{ choice.choice_label }}
                    </label>
                  </li>
                {% endfor %}
              </ul>
            </div>
          {% elif field.name == 'priority' %}
            {% include 'includes/priority_slider.html' with field=field %}
          {% elif field.field.widget.input_type == 'date' %}
            {% include 'includes/custom_date_picker.html' with field=field %}
          {% else %}
            <div class="[&_input]:block [&_input]:w-full [&_input]:rounded-md [&_input]:bg-gray-100 [&_input]:dark:bg-white/5 [&_input]:px-3 [&_input]:py-1.5 [&_input]:text-sm [&_input]:text-gray-900 [&_input]:dark:text-white [&_input]:border-0 [&_input]:placeholder:text-gray-500 [&_input]:focus:ring-2 [&_input]:focus:ring-cyan-600 [&_select]:block [&_select]:w-full [&_select]:rounded-md [&_select]:bg-gray-100 [&_select]:dark:bg-white/5 [&_select]:px-3 [&_select]:py-1.5 [&_select]:text-sm [&_select]:text-gray-900 [&_select]:dark:text-white [&_select]:border-0 [&_select]:focus:ring-2 [&_select]:focus:ring-cyan-600 [&_select]:appearance-none [&_select]:*:bg-white [&_select]:dark:*:bg-gray-800">
            {% if field.field.widget.input_type == 'select' %}
              <div class="grid grid-cols-1 select-wrapper">
                {{ field }}
                <span class="material-icons pointer-events-none col-start-1 row-start-1 mr-2 size-4 self-center justify-self-end text-gray-600 dark:text-gray-400" aria-hidden="true">expand_more</span>
              </div>
            {% else %}
              {{ field }}
            {% endif %}
            </div>
          {% endif %}
          {% if field.help_text %}
          <p class="mt-1 text-xs text-gray-600 dark:text-gray-400">{{ field.help_text }}</p>
          {% endif %}
          {% if field.errors %}
          <p class="mt-1 text-xs text-red-400">{{ field.errors }}</p>
          {% endif %}
        </dd>
      </div>
      {% else %}
      {{ field }}
      {% endif %}
      {% endfor %}
    </dl>
  </div>

  <div class="flex items-center justify-end gap-x-3 pt-4 mt-4 border-t border-gray-200 dark:border-white/10">
    <button type="button" onclick="window.location.href='{% url 'tasks_list' %}';" class="text-sm font-semibold text-gray-900 dark:text-white">Clear</button>
    <button type="button" command="close" commandfor="{{ modal_id }}" class="text-sm font-semibold text-gray-900 dark:text-white">Cancel</button>
    <button type="submit" class="rounded-md bg-cyan-600 px-3 py-2 text-sm font-semibold text-white hover:bg-cyan-500 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600">Apply Filters</button>
  </div>
</form>

<script>
  // Apply styles to select elements in this form
  (function() {
    const form = document.currentScript.closest('form');
    if (form) {
      const selects = form.querySelectorAll('.select-wrapper select');
      selects.forEach(select => {
        select.classList.add('col-start-1', 'row-start-1', 'block', 'w-full', 'rounded-md', 'bg-gray-100', 'dark:bg-white/5', 'px-3', 'py-1.5', 'text-sm', 'text-gray-900', 'dark:text-white', 'border-0', 'focus:ring-2', 'focus:ring-cyan-600', 'appearance-none');
      });
      
      // Style checkboxes
      const checkboxes = form.querySelectorAll('input[type="checkbox"]');
      checkboxes.forEach(checkbox => {
        checkbox.classList.add('col-start-1', 'row-start-1', 'appearance-none', 'rounded-sm', 'border', 'border-white/10', 'bg-white/5', 'checked:border-cyan-600', 'checked:bg-cyan-600', 'focus-visible:outline-2', 'focus-visible:outline-offset-2', 'focus-visible:outline-cyan-600', 'size-4');
      });
    }
  })();
</script>
